{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport './css/styles.css';\nimport axios from \"axios\";\nconst API_KEY = '42158298-7ee19009037b01d9fe650f472';\nconst URL = \"https://pixabay.com/api/\";\nconst form = document.querySelector(\".form-inline\");\nconst containerEl = document.querySelector(\".card-container\");\nconst loadMoreBtn = document.querySelector(\".label\");\nconst preloader = document.getElementById(\"preloader\");\nconst queryParams = {\n    q: \"\",\n    page: 1,\n    maxPage: 0,\n    per_page: 15,\n};\nlet currentSearchQuery = \"\";\nconst hiddenClass = \"is-hidden\";\n\nfunction hide(element) {\n    element.classList.add(hiddenClass);\n}\n\nfunction show(element) {\n    element.classList.remove(hiddenClass);\n}\n\nfunction enable(button) {\n    button.disabled = false;\n}\n\nfunction disable(button) {\n    button.disabled = true;\n}\n\nfunction showLoadingIndicator() {\n    preloader.style.display = \"block\";\n}\n\nfunction hideLoadingIndicator() {\n    preloader.style.display = \"none\";\n}\n\nform.addEventListener(\"submit\", handleSearch);\n\nasync function handleSearch(event) {\n    event.preventDefault();\n    containerEl.innerHTML = \"\";\n    const form = event.currentTarget;\n    const picture = form.elements.picture.value.trim();\n    currentSearchQuery = picture;\n    queryParams.page = 1; \n    if (picture === \"\" || picture == null) {\n        iziToast.error({\n            message: `Sorry, there are no images matching your search query. Please, try again!`,\n            position:\"topRight\"\n        });\n        hide(loadMoreBtn);\n        return;\n    }\n    showLoadingIndicator();\n    try {\n        const { hits, totalHits } = await searchPicture(picture);\n        if (hits && hits.length > 0) {\n            queryParams.maxPage = Math.ceil(totalHits / queryParams.per_page);\n            createPictureMarkup(hits, containerEl);\n            const lightbox = new SimpleLightbox('.card-container a', {\n                captionsData: 'alt',\n                captionPosition: 'bottom',\n                captionDelay: 250,\n            });\n            lightbox.refresh();\n            if (hits.length !== totalHits) {\n                show(loadMoreBtn);\n            } else {\n                hide(loadMoreBtn);\n            }\n        } else {\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please, try again!',\n                position:\"topRight\"\n            });\n            hide(loadMoreBtn);\n        }\n    } catch (err) {\n        console.log(err);\n    } finally {\n        hideLoadingIndicator();\n        form.reset();\n    }\n}\n\nasync function searchPicture(picture, page = 1) {\n    return axios.get(URL, {\n        params: {\n            key: API_KEY,\n            q: picture,\n            image_type: \"photo\",\n            orientation: \"horizontal\",\n            safesearch: true,\n            per_page: queryParams.per_page, \n            page,\n        }\n    }).then((res) => {\n        return res.data;\n    });\n}\n\nloadMoreBtn.addEventListener(\"click\", handleLoadMore);\n\nasync function handleLoadMore() {\n    queryParams.page += 1;\n    disable(loadMoreBtn);\n    try {\n        const { hits } = await searchPicture(currentSearchQuery, queryParams.page);\n        createPictureMarkup(hits, containerEl);\n        const lightbox = new SimpleLightbox('.card-container a', {\n            captionsData: 'alt',\n            captionPosition: 'bottom',\n            captionDelay: 250,\n        });\n        lightbox.refresh();\n        if (queryParams.page >= queryParams.maxPage) {\n            hide(loadMoreBtn);\n            iziToast.error({\n                title: \"Error\",\n                message: \"We're sorry, but you've reached the end of search results.\",\n            });\n        } else {\n            show(loadMoreBtn);\n        }\n    } catch (err) {\n        console.log(err);\n    } finally {\n        enable(loadMoreBtn);\n    }\n}\n\nfunction createPictureMarkup(hits, containerEl) {\n    const markup = hits.map(({ webformatURL, likes, views, comments, downloads, largeImageURL }) => `<a href=\"${largeImageURL}\" class=\"picture-link\">\n    <img src=\"${webformatURL}\">\n    <div class=\"picture-content\">\n        <div class=\"picture-text\">\n            <span class=\"picture-title\">Likes</span>\n            <span class=\"picture-sub-title\">${likes}</span>\n        </div>\n        <div class=\"picture-text\">\n            <span class=\"picture-title\">Views</span>\n            <span class=\"picture-sub-title\">${views}</span>\n        </div>\n        <div class=\"picture-text\">\n            <span class=\"picture-title\">Comments</span>\n            <span class=\"picture-sub-title\">${comments}</span>\n        </div>\n        <div class=\"picture-text\">\n            <span class=\"picture-title\">Downloads</span>\n            <span class=\"picture-sub-title\">${downloads}</span>\n        </div>\n    </div>\n</a>`).join(\"\");\n    containerEl.insertAdjacentHTML(\"beforeend\", markup);\n}\n"],"names":["API_KEY","URL","form","containerEl","loadMoreBtn","preloader","queryParams","currentSearchQuery","hiddenClass","hide","element","show","enable","button","disable","showLoadingIndicator","hideLoadingIndicator","handleSearch","event","picture","iziToast","hits","totalHits","searchPicture","createPictureMarkup","SimpleLightbox","err","page","axios","res","handleLoadMore","markup","webformatURL","likes","views","comments","downloads","largeImageURL"],"mappings":"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"}